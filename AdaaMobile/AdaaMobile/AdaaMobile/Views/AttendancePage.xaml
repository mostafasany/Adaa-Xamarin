<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sys="clr-namespace:System;assembly=System.Runtime"
             xmlns:ext="clr-namespace:AdaaMobile.MarkupExtensions;assembly=AdaaMobile"
             xmlns:controls="clr-namespace:AdaaMobile.Controls;assembly=AdaaMobile"
             xmlns:models="clr-namespace:AdaaMobile.Models;assembly=AdaaMobile"
             xmlns:converters="clr-namespace:AdaaMobile.Converters;assembly=AdaaMobile"
             x:Class="AdaaMobile.Views.AttendancePage"
             BackgroundColor="White"
             >
  <ContentPage.Resources>
    <ResourceDictionary>
      <converters:BoolToColorConverter x:Key="DayColorConverter"
       FalseColor="Black"  TrueColor="{StaticResource YellowAccent}"  />
      <converters:BoolToColorConverter x:Key="MonthColorConverter"
       FalseColor="Black"  TrueColor="White"  />
      <converters:BoolToColorConverter x:Key="DayBackColorConverter"
       FalseColor="#FFB4D7DB"  TrueColor="{StaticResource AppBackgroundLight}"  />
      <converters:StringFormatConverter x:Key="StringFormatConverter"/>
      <converters:DateFormatConverter x:Key="DateFormatConverter"/>
    </ResourceDictionary>
  </ContentPage.Resources>

  <ScrollView>
  <StackLayout Spacing="0"  Orientation="Vertical" VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand">

    <!--Top buttons Attendance and Exceptions-->
    <Grid  >
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      
      <Button Text="{ext:Translate Attendance}"
          Grid.Column="0"
          BorderRadius="0"
          BorderColor="{StaticResource AppBackgroundDark}"
          x:Name="AttendanceButton"
          Clicked="OnTabTapped"         
        />

      <Button Text="{ext:Translate Exceptions}"
          Grid.Column="1"
          BorderRadius="0"
          BorderColor="{StaticResource AppBackgroundDark}"
          x:Name="ExceptionsButton"
          Clicked="OnTabTapped"   
      />
    </Grid>

    <Label   Text="Select date to view your attendance details"
       TextColor="White"
               />

    <!--Date Pickers-->
    <Grid  >
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
            <!--<Image Source="splashscreen.jpg" 
             Aspect="AspectFill" Grid.ColumnSpan="2" 
             VerticalOptions="Fill" HorizontalOptions="Fill"/>-->
      <!--DatePicker isn't customizable, So Hide it and put cutomizable 
        button that triggers Date picker with it's specification-->
      <DatePicker
          Grid.Column="0"
          WidthRequest="0" HeightRequest="0"
          x:Name="MinDatePicker"
          Format="d MMM yyyy"
          Date="{Binding StartDate}"
          MaximumDate="{Binding EndDate}"
          
            />

      <controls:ImageButton Grid.Column="0"
              Text="{Binding StartDate,
                Converter={StaticResource DateFormatConverter},
                ConverterParameter=d MMM yyyy}"
              Image="icon.png"
              Clicked="StartDate_Clicked"
              ImageHeightRequest="40"
              ImageWidthRequest="40"  
              BackgroundColor="{StaticResource AppBackgroundLight}"
                />

      <!--DatePicker isn't customizable, So Hide it and put cutomizable 
        button that triggers Date picker with it's specification-->
      <DatePicker
          Grid.Column="1"
          x:Name="MaxDatePicker"
          Format="d MMM yyyy"
          Date="{Binding EndDate}"
          WidthRequest="0" HeightRequest="0"
          MinimumDate="{Binding StartDate}"
          MaximumDate="{x:Static sys:DateTime.Now}"
                    />
      <controls:ImageButton Grid.Column="1"
                Text="{Binding EndDate,
                Converter={StaticResource DateFormatConverter},
                ConverterParameter=d MMM yyyy}"
                Image="icon.png"
                Clicked="EndDate_Clicked"
                ImageHeightRequest="40"
                ImageWidthRequest="40"           
                BackgroundColor="{StaticResource AppBackgroundLight}"
                />
    </Grid>
    <RelativeLayout VerticalOptions="Start" >
      <ListView Rotation="270"
                HorizontalOptions="Fill"              
                HeightRequest="80"
                RowHeight="60"
                x:Name="DaysList"
                InputTransparent="True"
                ItemTapped="DayItem_Tapped"
                ItemsSource="{Binding DaysList}"
                RelativeLayout.XConstraint="{ConstraintExpression Type=RelativeToParent, Property=Width, Factor=0.5, Constant=-40}"
                RelativeLayout.YConstraint="{ConstraintExpression Type=RelativeToParent, Property=Width, Factor=-0.5, Constant=40}"
                RelativeLayout.WidthConstraint="{ConstraintExpression Type=Constant, Constant=80}"
                RelativeLayout.HeightConstraint="{ConstraintExpression Type=RelativeToParent, Property=Width, Factor=1}"
          >
        <ListView.ItemTemplate>
          <DataTemplate>
            <ViewCell>
              <ViewCell.View>
                <Grid RowSpacing="0" Rotation="90"
                     TranslationX="20"                              >

                  <Grid.RowDefinitions>
                    <RowDefinition  Height="Auto"/>
                    <RowDefinition  Height="Auto"/>
                  </Grid.RowDefinitions>

                  <Label Grid.Row="0"
                         VerticalOptions="Fill"
                         HorizontalTextAlignment="Center"
                         HorizontalOptions="Fill"
                         BackgroundColor="{StaticResource YellowAccent}"
                         TextColor="Black"
                         FontSize="Small"
                         Text="{Binding AbbrWeek}"/>
                  <BoxView BackgroundColor="{Binding IsSelected,Converter={StaticResource DayBackColorConverter}}"
                           x:Name="DayBack"
                           VerticalOptions="Fill"
                           HorizontalOptions="Fill"
                           Grid.Row="1"/>
                  <StackLayout VerticalOptions="Center"
                               HorizontalOptions="Center"
                               Padding="12,8" Spacing="2"
                               Grid.Row="1">
                    <Label x:Name="DayLabel"
                           BackgroundColor="Transparent"
                           TextColor="{Binding IsSelected,Converter={StaticResource DayColorConverter}}"
                           FontSize="Medium" FontAttributes="Bold"
                           HorizontalTextAlignment="Center"
                           Text="{Binding Day}"/>
                    <Label
                         x:Name="MonthLabel"
                          BackgroundColor="Transparent"
                         TextColor="{Binding IsSelected,Converter={StaticResource MonthColorConverter}}"
                         FontSize="Small"
                         HorizontalTextAlignment="Center"
                         Text="{Binding AbbrMonth}"/>
                  </StackLayout>
                </Grid>
              </ViewCell.View>
            </ViewCell>
          </DataTemplate>

        </ListView.ItemTemplate>
      </ListView>
    </RelativeLayout>
    <StackLayout VerticalOptions="FillAndExpand">
      <Grid VerticalOptions="FillAndExpand" BackgroundColor="{StaticResource AppBackgroundLight}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Label TextColor="Black" Text="Date" Grid.Column="0"/>
        <Label TextColor="Black" Text=":" Grid.Column="1"/>
        <Label TextColor="Black" Text="1 Oct 2015" Grid.Column="2"/>
      </Grid>
    </StackLayout>

    <Button
                
        HorizontalOptions="FillAndExpand"
        BackgroundColor="White"
        TextColor="Black"
        BorderRadius="5"
        Text="{ext:Translate Delegation}"
                >
    </Button>

    <Button
        HorizontalOptions="FillAndExpand"
        BackgroundColor="White"
        TextColor="{StaticResource AppBackgroundLight}"
        BorderRadius="5"
        Text="{ext:Translate DayPass}"
                >
    </Button>
    <controls:ImageButton
        HorizontalOptions="FillAndExpand"
        VerticalOptions="Start"
        BackgroundColor="{StaticResource AppBackgroundLight}"
        TextColor="Red"
        BorderRadius="5"
        ImageHeightRequest="20"
        ImageWidthRequest="20"
        Orientation="ImageToLeft"
        Image="icon.png"
        Text="{ext:Translate AdaaTimesheet}"
                >

    </controls:ImageButton>
  </StackLayout>

  </ScrollView>

</ContentPage>